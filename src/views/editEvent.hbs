
<head>
  <link rel="stylesheet" href="/css/createEditEvent.css">
</head>

<a href="/" class="back-link">&lt; Back</a>

<div class="container-box">
    <h1>Edit Event</h1>

    <!-- Title -->
    <div class="mb-3">
        <label>Title Name</label>
        <input type="text" id="eventTitle" class="form-control" placeholder="Enter title">
    </div>

    <!-- Description -->
    <div class="mb-3">
        <label>Description</label>
        <input type="text" id="eventDescription" class="form-control" placeholder="Input text here">
    </div>

    <!-- upload image here-->
    <div class="mb-3 text-center">
        <div id="imagePreview" class="image-box">
        Sample Announcement Image<br>and Captions
        </div>
        <input type="file" id="eventImage" accept="image/*" class="form-control d-none">
        <button id="editImageBtn" class="btn btn-edit">Edit image</button>
    </div>

    <!-- Event Details -->
    <div class="mt-4">
        <label class="fw-bold d-block">Event details:</label>
        <div class="row g-3 align-items-center">
        <div class="col-md-6">
            <label class="form-label">No. of Attendees:</label>
            <input type="number" id="eventAttendees" class="form-control" placeholder="Enter number">
        </div>
        <div class="col-md-6">
            <label class="form-label">Type:</label>
            <select id="eventType" class="form-select">
            <option>Select type</option>
            <option>Meeting</option>
            <option>Workshop</option>
            <option>Social</option>
            </select>
        </div>
        </div>

        <div class="row g-3 mt-2">
        <div class="col-md-6">
            <label class="form-label">Date:</label>
            <input type="date" id="eventDate" class="form-control">
        </div>
        <div class="col-md-6">
            <label class="form-label">Time:</label>
            <input type="time" id="eventTime" class="form-control">
        </div>
        </div>
    </div>

    <!-- Send Invitation -->
    <div class="mt-4">
        <label class="fw-bold d-block">Send invitation:</label>

        <div class="d-flex align-items-center flex-wrap gap-3">
            <div>
                <input type="checkbox" id="sendAll">
                <label for="sendAll">Send to all members</label>
            </div>

            <div class="d-flex align-items-center">
                <input type="checkbox" id="custom">
                <label for="custom" class="ms-2 me-2">Custom:</label>
                <select id="customSelect" class="form-select" style="width: 160px; display: none;">
                <option>Select member</option>
                <option>John Doe</option>
                <option>Jane Smith</option>
                <option>Michael Lee</option>
                </select>
            </div>
        </div>
    </div>
    <!-- Buttons -->
    <div class="bottom-buttons">
        <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
        <button class="btn btn-danger" id="deleteBtn">Delete</button>
        <button class="btn btn-warning" id="editBtn">Edit</button>
    </div>
</div>

<script>
let uploadedImage = "";

// --- Image Upload ---
document.getElementById("editImageBtn").addEventListener("click", () => {
    document.getElementById("eventImage").click();
});

document.getElementById("eventImage").addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
    const reader = new FileReader();
    reader.onload = (event) => {
        const preview = document.getElementById("imagePreview");
        preview.style.backgroundImage = `url('${event.target.result}')`;
        preview.style.backgroundSize = "cover";
        preview.style.backgroundPosition = "center";
        preview.textContent = "";
        uploadedImage = event.target.result;
    };
    reader.readAsDataURL(file);
    }
});

// --- for custom invites ---
const customCheckbox = document.getElementById("custom");
const customSelect = document.getElementById("customSelect");
const sendAllCheckbox = document.getElementById("sendAll");

customCheckbox.addEventListener("change", () => {
    if (customCheckbox.checked) {
    sendAllCheckbox.checked = false;
    customSelect.style.display = "inline-block";
    } else {
    customSelect.style.display = "none";
    }
});

sendAllCheckbox.addEventListener("change", () => {
    if (sendAllCheckbox.checked) {
    customCheckbox.checked = false;
    customSelect.style.display = "none";
    }
});

// --- Used to clear the forms as a func ---
function clearForm() {
    document.querySelectorAll("input, select").forEach(el => {
    if (el.type === "checkbox") el.checked = false;
    else el.value = "";
    });
    const preview = document.getElementById("imagePreview");
    preview.style.backgroundImage = "";
    preview.textContent = "Sample Announcement Image\nand Captions";
    customSelect.style.display = "none";
    uploadedImage = "";
}

// --- Buttons functionality ---
document.getElementById("editBtn").addEventListener("click", () => {
    const eventData = {
    title: document.getElementById("eventTitle").value,
    description: document.getElementById("eventDescription").value,
    attendees: document.getElementById("eventAttendees").value,
    type: document.getElementById("eventType").value,
    date: document.getElementById("eventDate").value,
    time: document.getElementById("eventTime").value,
    sendAll: document.getElementById("sendAll").checked,
    custom: document.getElementById("custom").checked ? document.getElementById("customSelect").value : "",
    image: uploadedImage
    };

    localStorage.setItem("savedEvent", JSON.stringify(eventData));
    alert("âœ… Event edited successfully!");
    clearForm();
});

document.getElementById("deleteBtn").addEventListener("click", () => {
    if (confirm("Are you sure you want to delete this event?")) {
    localStorage.removeItem("savedEvent");
    alert("ðŸ—‘ï¸ Event deleted successfully!");
    clearForm();
    }
});

document.getElementById("cancelBtn").addEventListener("click", () => {
    if (confirm("Cancel and clear all fields?")) {
    clearForm();
    }
});
</script>
